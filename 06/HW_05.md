### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надежность работы БД и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1 Необходимо восстанавливать данные в полном объеме за предыдущий день.

**ответ**

Можно использовать полную реплику, например, на прошлое воскресенье.
Далее, докатить изменения через инкрементальные или дифференциальные изменения.

1.2 Необходимо восстанавливать данные за час до предполагаемой поломки.

**ответ**

Базу данных, восстановленную на минувший день.
Далее, использовать журнал резервирования

1.3* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую/починеную БД?

**ответ**

Да. Например, если мы используем репликацию базы данных и "рядом" есть работающий инстанс.

Переключение должно быть настроение либо на уровне приложения, либо на уровне reverse-proxy.

---

### Задание 2. PostgreSQL

2.1 С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

**ответ**

`pg_dump.exe --dbname=avia --file="C:\\db_avia.backup" --create`

2.1* Возможно ли автоматизировать этот процесс? Если да, то как?

**ответ**

Можно использовать cron-задание, выполняющее задание на бекап.

Альтерантивно, настроить задания через pgAgent или другую утилиту.

---

### Задание 3. MySql

3.1 С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySql. 

**ответ**

Сначала нужно восстановить базу данных из бекапа
`mysql -u root -p sakila < sakila_backup.sql`

Выполнить команду для сохранения логов `mysqladmin -uroot -p flush-logs`

Скопировать логи в папку с бекапами, в исходном расположении логи необходимо удалить.

Далее нужно выполнить команду, для восстановления данных из лог-файлов

`mysqlbinlog /var/log/mysql/mysql-bin.000002 | mysql -u root -p sakila`


3.1* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

**ответ**

Ключевое преимущество, с точки зрения бекапирования, это скорость восстановления доступа к базе  данных.

Другие преимущество - снижение нагрузки на мастер-базу. Это можно рассматривать как аргумент для разворачивания дополнительного сервера для БД.
